<app-clientnav></app-clientnav>
<div id="ticketDetailsContainer">
  <h1>Ticket Details</h1>
  <hr />

  <ng-container *ngIf="ticket; else loadingOrError">
    <div class="cards-container">
      <div class="ticket-card">
        <h1>{{ ticket.ticketId }}</h1>
        <h2>{{ ticket.title }}</h2>
        <p><strong>Description:</strong> {{ ticket.description }}</p>
        <p><strong>Issue Category:</strong> {{ ticket.issueCategory }}</p>
        <p><strong>Priority:</strong> {{ ticket.priority }}</p>
        <p><strong>Status:</strong> {{ ticket.status }}</p>
        <p><strong>Created Date:</strong> {{ ticket.createdDate | date: 'yyyy-MM-dd' }}</p>
        <p><strong>Resolution Date:</strong> {{ ticket.resolutionDate ? (ticket.resolutionDate | date: 'yyyy-MM-dd') : 'Not Resolved' }}</p>
      </div>

      <div class="agent-card" *ngIf="agent">
        <h2>Agent Details</h2>
        <p><strong>Name:</strong> {{ agent.name }}</p>
        <p><strong>Email:</strong> {{ agent.email }}</p>
        <p><strong>Phone:</strong> {{ agent.phone }}</p>
        <p><strong>Expertise:</strong> {{ agent.expertise }}</p>
        <p><strong>Status:</strong> {{ agent.status }}</p>
        <div class="action-buttons" *ngIf="ticket.status === 'Open'">
          <button class="accept-button" (click)="showPopup('accept')">Accept Agent</button>
          <button class="reject-button" (click)="showPopup('reject')">Reject Agent</button>
        </div>
      </div>
    </div>
  </ng-container>

  <ng-template #loadingOrError>
    <p *ngIf="isLoading">Loading ticket details...</p>
    <p *ngIf="errorMessage">{{ errorMessage }}</p>
  </ng-template>

  <div *ngIf="showActionPopup" class="action-popup">
    <div class="action-popup-content">
      <h2>{{ popupMessage }}</h2>
      <button class="ok-button" (click)="confirmAction()">OK</button>
      <button class="cancel-button" (click)="closePopup()">Cancel</button>
    </div>
  </div>
</div>
