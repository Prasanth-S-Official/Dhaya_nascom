<app-usernav></app-usernav>
<div class="container" [ngClass]="{ blur: successPopup }">
  <div class="button-container">
    <button (click)="navigateBack()">Back</button>
  </div>
  <h2>WiFi Scheme Request Form</h2>

  <form [formGroup]="requestForm" (ngSubmit)="onSubmit()">
    <!-- Address Fields -->
    <div>
      <label for="streetName">Street Name<span class="required">*</span></label>
      <input id="streetName" type="text" formControlName="streetName" />
      <div *ngIf="requestForm.controls['streetName']?.touched && requestForm.controls['streetName'].hasError('required')" class="error">
        *Street Name is required
      </div>
    </div>
    <div>
      <label for="landmark">Landmark<span class="required">*</span></label>
      <input id="landmark" type="text" formControlName="landmark" />
      <div *ngIf="requestForm.controls['landmark']?.touched && requestForm.controls['landmark'].hasError('required')" class="error">
        *Landmark is required
      </div>
    </div>
    <div>
      <label for="city">City<span class="required">*</span></label>
      <input id="city" type="text" formControlName="city" />
      <div *ngIf="requestForm.controls['city']?.touched && requestForm.controls['city'].hasError('required')" class="error">
        *City is required
      </div>
    </div>
    <div>
      <label for="state">State<span class="required">*</span></label>
      <input id="state" type="text" formControlName="state" />
      <div *ngIf="requestForm.controls['state']?.touched && requestForm.controls['state'].hasError('required')" class="error">
        *State is required
      </div>
    </div>
    <div>
      <label for="zipCode">ZIP Code<span class="required">*</span></label>
      <input id="zipCode" type="text" formControlName="zipCode" />
      <div *ngIf="requestForm.controls['zipCode']?.touched && requestForm.controls['zipCode'].hasError('required')" class="error">
        *ZIP Code is required
      </div>
    </div>

    <!-- Setup Preferences -->
    <div>
      <label for="preferredSetupDate">Preferred Setup Date<span class="required">*</span></label>
      <input id="preferredSetupDate" type="date" formControlName="preferredSetupDate" />
      <div *ngIf="requestForm.controls['preferredSetupDate']?.touched && requestForm.controls['preferredSetupDate'].hasError('required')" class="error">
        *Preferred Setup Date is required
      </div>
    </div>
    <div>
      <label for="timeSlot">Preferred Time Slot<span class="required">*</span></label>
      <select id="timeSlot" formControlName="timeSlot">
        <option value="">Select a time slot</option>
        <option value="Morning">Morning</option>
        <option value="Afternoon">Afternoon</option>
        <option value="Evening">Evening</option>
      </select>
      <div *ngIf="requestForm.controls['timeSlot']?.touched && requestForm.controls['timeSlot'].hasError('required')" class="error">
        *Time slot is required
      </div>
    </div>

    <!-- Proof Upload -->
    <div>
      <label for="proof">Upload Proof<span class="required">*</span></label>
      <input id="proof" type="file" (change)="handleFileChange($event)" />
      <div *ngIf="imageError" class="error">
        *{{ imageError }}
      </div>
    </div>

    <!-- Comments Field -->
    <div>
      <label for="comments">Comments</label>
      <textarea id="comments" formControlName="comments"></textarea>
    </div>

    <!-- Error Message -->
    <div *ngIf="errorMessage" class="error">
      *{{ errorMessage }}
    </div>

    <!-- Submit Button -->
    <div>
      <button type="submit" class="submit-button">Submit</button>
    </div>
  </form>
</div>

<!-- Success Popup -->
<div *ngIf="successPopup" class="success-popup">
  <p>Request Submitted Successfully!</p>
  <button (click)="handleSuccessMessage()">Ok</button>
</div>
